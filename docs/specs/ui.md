# UI/UX Specification

> 프론트엔드 작업 시 이 문서를 참조하세요: `@docs/specs/ui.md`

## Overview

- **Framework**: React 18.2+ with TypeScript
- **Build Tool**: Vite 5.0+
- **Styling**: Tailwind CSS 3.4+ + shadcn/ui
- **State**: React Query 5.0+ (서버 상태)
- **Forms**: React Hook Form + Zod
- **Charts**: Recharts

---

## Pages

| 페이지 | 경로 | 설명 |
|--------|------|------|
| LoginPage | `/login` | 로그인 |
| SalePage | `/sales/new` | 거래 입력 |
| SaleListPage | `/sales` | 거래 목록 |
| ReportPage | `/reports` | 리포트 |
| ReservationPage | `/reservations` | 예약 관리 |

---

## 1. 거래 입력 화면 (SalePage)

### Layout

```
┌─────────────────────────────────────────────────────────────┐
│ [Header] 거래 입력                              [저장] [취소] │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ A. 거래 기본정보                                        │ │
│ │ 거래일: [2026-01-17 ▼]  상태: [완료됨 ▼]  메모: [____] │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ B. 고객 선택                                            │ │
│ │ [고객 검색...]              [+ 신규 고객]               │ │
│ │ ✓ 홍길동 (010-1234-5678) - 정액권 잔액: 150,000원      │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ C. 담당 디자이너                                        │ │
│ │ [김디자이너 ▼]                                         │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ D. 시술/상품                            [+ 항목 추가]   │ │
│ │ ┌───────────────────────────────────────────────────┐   │ │
│ │ │ 종류    │ 항목명         │ 수량 │ 단가    │ 합계   │🗑│ │
│ │ ├───────────────────────────────────────────────────┤   │ │
│ │ │ 시술    │ 커트 (여성)    │  1   │ 35,000 │ 35,000 │ X │ │
│ │ │ 상품    │ 샴푸 500ml     │  1   │ 18,000 │ 18,000 │ X │ │
│ │ └───────────────────────────────────────────────────┘   │ │
│ │                                      소계: 53,000원     │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ E. 할인                                                 │ │
│ │ 할인 유형: [% ▼] [15] %  사유: [정액권 고객 할인]      │ │
│ │                                    할인액: -7,950원     │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ F. 결제                                 [+ 결제 추가]   │ │
│ │ ┌───────────────────────────────────────────────────┐   │ │
│ │ │ 결제수단       │ 금액           │                │🗑│ │
│ │ ├───────────────────────────────────────────────────┤   │ │
│ │ │ [카드 ▼]      │ [30,000]       │                │ X │ │
│ │ │ [정액권 ▼]    │ [15,050]       │ 잔액: 150,000 │ X │ │
│ │ └───────────────────────────────────────────────────┘   │ │
│ │                                    결제 합계: 45,050원  │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ G. 요약                                                 │ │
│ │ 항목 합계:    53,000원                                  │ │
│ │ 할인:        -7,950원                                   │ │
│ │ ─────────────────────                                   │ │
│ │ 최종 금액:   45,050원                                   │ │
│ │ 결제 합계:   45,050원  ✓ 일치                          │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### Component Structure

```
SalePage
├── SaleForm
│   ├── SaleBasicInfo          # A. 거래 기본정보
│   ├── CustomerSelect         # B. 고객 선택
│   │   └── NewCustomerDialog
│   ├── StaffSelect            # C. 담당 디자이너
│   ├── LineItemList           # D. 시술/상품
│   │   ├── LineItemRow
│   │   └── CatalogSearchDialog
│   ├── DiscountSection        # E. 할인
│   ├── PaymentSection         # F. 결제
│   │   └── PaymentRow
│   └── SaleSummary            # G. 요약
└── SaveButton
```

### Interactions

#### A. 거래 기본정보
- **거래일**: DatePicker, 기본값 오늘, 과거 선택 가능
- **상태**: Select (completed 고정, MVP에서는 변경 불가)
- **메모**: 선택적 텍스트 입력

#### B. 고객 선택
- **검색창**: debounce 300ms, 2글자 이상 입력 시 검색
- **검색 결과**: 드롭다운으로 표시 (최대 10개)
- **선택 시**: 고객 정보 + 정액권 잔액 표시
- **신규 고객**: Dialog 열림 → 생성 → 자동 선택

#### C. 담당 디자이너
- **Select**: active 사용자만 표시
- **기본값**: 현재 로그인 사용자 (staff인 경우)

#### D. 시술/상품
- **항목 추가**: Dialog 열림 (카탈로그 선택 또는 직접 입력)
- **수량**: number input, 최소 1
- **단가**: number input, 카탈로그 선택 시 자동 채움 (수정 가능)
- **합계**: 자동 계산 (수량 × 단가)
- **삭제**: X 버튼 클릭

#### E. 할인
- **할인 유형**: % 또는 원
- **값 입력**: % 시 0~100, 원 시 소계 이하
- **할인액**: 실시간 계산 표시

#### F. 결제
- **결제수단 선택**: cash, card, transfer, stored_value, giftcard, other
- **금액 입력**: 남은 금액 자동 계산 힌트
- **정액권 선택 시**: 현재 잔액 표시, 잔액 초과 시 에러
- **결제 추가**: 분할 결제용

#### G. 요약
- **항목 합계**: sum(line_total)
- **할인**: 계산된 할인액
- **최종 금액**: 항목 합계 - 할인
- **결제 합계**: sum(payment.amount)
- **상태**: 일치 ✓ / 불일치 ⚠️

#### 저장 버튼
- **활성화 조건**: 고객 선택됨, 디자이너 선택됨, 항목 1개 이상, 결제 합계 일치
- **성공**: 토스트 "거래가 저장되었습니다" + 폼 초기화
- **실패**: 에러 메시지 표시

---

## 2. 리포트 화면 (ReportPage)

### Layout

```
┌─────────────────────────────────────────────────────────────┐
│ [Header] 리포트                                              │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 기간 선택                                               │ │
│ │ [일별 ○] [월별 ○]   [< 이전] 2026년 1월 17일 [다음 >]  │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 요약 카드                                               │ │
│ │ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │ │
│ │ │ 총 매출  │ │ 순 매출  │ │ 거래 건수│ │ 신규고객 │     │ │
│ │ │1,250,000 │ │1,162,500 │ │    25    │ │    3     │     │ │
│ │ └──────────┘ └──────────┘ └──────────┘ └──────────┘     │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 매출 차트                                               │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │   [시간대별 바 차트 또는 일별 라인 차트]            │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [디자이너별] [결제수단별] [시술/상품별]                 │ │
│ ├─────────────────────────────────────────────────────────┤ │
│ │ 디자이너별 매출                                         │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 디자이너   │ 매출       │ 건수 │ 평균단가 │ 비율   │ │ │
│ │ ├─────────────────────────────────────────────────────┤ │ │
│ │ │ 김디자이너 │ 520,000원  │  12  │ 43,333  │ 44.7%  │ │ │
│ │ │ 이디자이너 │ 480,000원  │  10  │ 48,000  │ 41.3%  │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### Component Structure

```
ReportPage
├── DateSelector
│   ├── PeriodToggle (일별/월별)
│   └── DatePicker
├── SummaryCards
│   ├── Card (총 매출)
│   ├── Card (순 매출)
│   ├── Card (거래 건수)
│   └── Card (신규 고객)
├── SalesChart
│   ├── HourlyBarChart (일별)
│   └── DailyLineChart (월별)
└── DetailTabs
    ├── StaffTable
    ├── MethodTable
    └── CategoryTable
```

### Interactions

#### 기간 선택
- **일별/월별 토글**: 선택에 따라 DatePicker 모드 변경
- **이전/다음**: 일별은 ±1일, 월별은 ±1월
- **오늘/이번달**: 바로가기 버튼

#### 요약 카드
- **총 매출**: 할인 전 금액 합계
- **순 매출**: 할인 후 금액 합계 (=결제 합계)
- **거래 건수**: completed 상태만
- **신규 고객**: first_visit_at이 해당 기간인 고객 수

#### 매출 차트
- **일별**: 시간대별 바 차트 (10시~21시)
- **월별**: 일별 라인 차트

#### 상세 테이블
- 탭으로 디자이너별/결제수단별/시술상품별 전환
- 정렬: 매출 내림차순 기본

---

## 3. 거래 목록 화면 (SaleListPage)

### Layout

```
┌─────────────────────────────────────────────────────────────┐
│ [Header] 거래 목록                            [+ 새 거래]   │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 필터                                                    │ │
│ │ 기간: [2026-01-01] ~ [2026-01-17]  담당자: [전체 ▼]   │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 거래일  │ 고객     │ 담당자    │ 금액    │ 상태 │ 액션 │ │
│ ├─────────────────────────────────────────────────────────┤ │
│ │ 01-17   │ 홍길동   │ 김디자이너 │ 45,050 │ 완료 │ 취소 │ │
│ │ 01-17   │ 이영희   │ 박디자이너 │ 35,000 │ 완료 │ 취소 │ │
│ │ 01-16   │ 김철수   │ 김디자이너 │ 28,000 │ 취소 │      │ │
│ └─────────────────────────────────────────────────────────┘ │
│ [< 이전] 페이지 1/10 [다음 >]                               │
└─────────────────────────────────────────────────────────────┘
```

---

## Component Directory

```
frontend/src/
├── components/
│   ├── ui/                 # shadcn/ui 컴포넌트
│   │   ├── button.tsx
│   │   ├── input.tsx
│   │   ├── select.tsx
│   │   ├── table.tsx
│   │   ├── card.tsx
│   │   ├── dialog.tsx
│   │   ├── toast.tsx
│   │   └── ...
│   ├── layout/
│   │   ├── Header.tsx
│   │   ├── Sidebar.tsx
│   │   └── Layout.tsx
│   ├── sale/
│   │   ├── SaleForm.tsx
│   │   ├── SaleBasicInfo.tsx
│   │   ├── CustomerSelect.tsx
│   │   ├── StaffSelect.tsx
│   │   ├── LineItemList.tsx
│   │   ├── LineItemRow.tsx
│   │   ├── DiscountSection.tsx
│   │   ├── PaymentSection.tsx
│   │   ├── PaymentRow.tsx
│   │   └── SaleSummary.tsx
│   └── report/
│       ├── DateSelector.tsx
│       ├── SummaryCards.tsx
│       ├── SalesChart.tsx
│       ├── StaffTable.tsx
│       ├── MethodTable.tsx
│       └── CategoryTable.tsx
├── pages/
│   ├── LoginPage.tsx
│   ├── SalePage.tsx
│   ├── SaleListPage.tsx
│   └── ReportPage.tsx
├── hooks/
│   ├── useAuth.ts
│   ├── useCustomers.ts
│   ├── useCatalog.ts
│   ├── useSales.ts
│   └── useReports.ts
├── lib/
│   ├── api.ts
│   ├── types.ts
│   └── utils.ts
└── contexts/
    └── AuthContext.tsx
```

---

## Payment Method Icons

| 결제수단 | 아이콘 | 색상 |
|----------|--------|------|
| cash | 💵 | green |
| card | 💳 | blue |
| transfer | 🏦 | purple |
| stored_value | 🎫 | orange |
| giftcard | 🎁 | pink |
| other | 📝 | gray |

---

## Validation Rules

### 거래 저장 조건
1. 고객 선택됨
2. 디자이너 선택됨
3. 항목 1개 이상
4. 결제 합계 = 최종 금액
5. 정액권 사용 시 잔액 충분

### 에러 메시지

| 필드 | 에러 | 메시지 |
|------|------|--------|
| customer_id | 필수 | "고객을 선택해주세요" |
| staff_id | 필수 | "담당 디자이너를 선택해주세요" |
| items | 필수 | "시술/상품을 1개 이상 추가해주세요" |
| payments | 불일치 | "결제 금액이 일치하지 않습니다" |
| stored_value | 잔액부족 | "정액권 잔액이 부족합니다" |

---

## 4. 예약 관리 화면 (ReservationPage)

### Layout

```
┌─────────────────────────────────────────────────────────────┐
│ [Header] 예약관리                                             │
│ [오늘] [< 이전] 2026년 01월 21일 (화) [다음 >]  [+ 예약추가]  │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 캘린더 (주간 날짜 선택)                                  │ │
│ │ [일] [월] [화] [수] [목] [금] [토]                       │ │
│ │ 19   20   21   22   23   24   25                        │ │
│ └─────────────────────────────────────────────────────────┘ │
│ ┌──────────┐ ┌──────────┐ ┌──────────┐                      │
│ │ 오늘 예약│ │ 완료     │ │ 취소     │                      │
│ │    5건   │ │   2건    │ │   1건    │                      │
│ └──────────┘ └──────────┘ └──────────┘                      │
│                                                              │
│ 상태 범례: ● 예약됨  ● 완료  ● 취소                         │
│                                                              │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 예약 그리드                                              │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 담당자 │ 10:00 │ 10:30 │ 11:00 │ 11:30 │ ... │ 20:00│ │ │
│ │ ├─────────────────────────────────────────────────────┤ │ │
│ │ │ ● 김디│ [===홍길동 커트 60분===]        │       │     │ │ │
│ │ │ ● 박디│       │ [===이영희 펌 90분======]│       │     │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### Component Structure

```
ReservationPage
├── Header
│   ├── DateNavigation (이전/오늘/다음)
│   └── AddReservationButton
├── ReservationCalendar (주간 날짜 선택)
├── SummaryCards (오늘 예약/완료/취소 건수)
├── StatusLegend (예약됨/완료/취소 색상 범례)
├── ReservationGrid
│   ├── TimeHeader (10:00 ~ 20:00, 30분 단위)
│   ├── StaffRows
│   │   ├── StaffInfo (이름, 색상)
│   │   ├── TimeSlots (빈 슬롯, 클릭 가능)
│   │   └── ReservationBlocks (드래그 가능)
├── ReservationFormModal (등록/수정)
└── ReservationDetailModal (상세 보기)
```

### Interactions

#### 날짜 선택
- **이전/다음**: 하루씩 이동
- **오늘**: 오늘 날짜로 이동
- **캘린더**: 주간 날짜 클릭으로 선택

#### 예약 그리드
- **빈 슬롯 클릭**: 해당 담당자/시간으로 예약 등록 모달 열림
- **예약 블록 클릭**: 예약 상세 모달 열림
- **드래그 앤 드롭**: 예약 블록을 다른 시간/담당자로 이동
  - 시간 충돌 시 이동 불가
  - 취소된 예약은 드래그 불가
  - 드래그 중 대상 슬롯 하이라이트 표시

#### 예약 블록
- **색상**: 상태별 색상 구분
  - 예약됨: 파란색 (`bg-blue-100`)
  - 완료: 초록색 (`bg-green-100`)
  - 취소: 빨간색 (`bg-red-100`)
- **내용**: 고객명, 신규 표시, 시술명, 소요시간
- **너비**: 소요시간에 비례 (30분 = 1슬롯)

#### 예약 상세 모달
- **정보 표시**: 고객, 담당자, 시술, 상태, 날짜, 시간, 메모
- **액션 버튼** (예약됨 상태일 때):
  - 거래입력: `/sale` 페이지로 이동 (고객/담당자/시술 정보 전달)
  - 수정: 예약 수정 모달 열림
  - 취소: 예약 상태를 '취소'로 변경
- **닫기**: 모달 닫기

#### 예약 등록/수정 모달
- **필드**: 고객, 담당자, 시술, 날짜, 시간, 메모
- **시간 충돌 검사**: 동일 담당자의 겹치는 시간대 예약 방지
- **저장**: 유효성 검사 후 저장

### Drag and Drop

#### 드래그 시작
- `draggable={true}` (취소된 예약 제외)
- `dataTransfer.setData("text/plain", reservationId)`
- 커서: `cursor-grab` → `cursor-grabbing`

#### 드롭 영역
- 모든 시간 슬롯이 드롭 영역
- `data-drop-zone="true"`, `data-staff-id`, `data-time` 속성

#### 드롭 처리
1. 대상 슬롯의 staffId, staffName, time 추출
2. 시간 충돌 검사 (같은 담당자, 같은 날짜, 시간 겹침)
3. 충돌 없으면 예약 업데이트
4. 충돌 있으면 이동 취소 (무시)

#### 시각적 피드백
- 드래그 중 대상 슬롯: `bg-primary-100` 하이라이트
- 드래그 종료 시 하이라이트 제거
